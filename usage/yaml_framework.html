

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Yaml Formatting &mdash; Fre-Cli 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=a6a68382" />
      <link rel="stylesheet" type="text/css" href="../_static/fonts.css?v=5583d106" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Fre-Cli
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../what-is-fre.html">What is FRE?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup.html">Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../for-developers.html">For developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../badges.html">Badges</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Fre-Cli</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Yaml Formatting</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/usage/yaml_framework.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p>In order to utilize these FRE tools, a distrubuted YAML structure is required. This framework includes a main model yaml, a compile yaml, a platforms yaml, and post-processing yamls. Throughout the compilation and post-processing steps, combined yamls that will be parsed for information are created. Yamls follow a dictionary-like structure with <code class="docutils literal notranslate"><span class="pre">[key]:</span> <span class="pre">[value]</span></code> fields.</p>
<section id="yaml-formatting">
<h1>Yaml Formatting<a class="headerlink" href="#yaml-formatting" title="Link to this heading"></a></h1>
<p>Helpful information and format recommendations for creating yaml files.</p>
<ol class="arabic simple">
<li><p>You can define a block of values as well as individual <code class="docutils literal notranslate"><span class="pre">[key]:</span> <span class="pre">[value]</span></code> pairs:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">section</span> <span class="n">name</span><span class="p">:</span>
  <span class="n">key</span><span class="p">:</span> <span class="n">value</span>
  <span class="n">key</span><span class="p">:</span> <span class="n">value</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p><code class="docutils literal notranslate"><span class="pre">[key]:</span> <span class="pre">[value]</span></code> pairs can be made a list by utilizing a <code class="docutils literal notranslate"><span class="pre">-</span></code>:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">section</span> <span class="n">name</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">key</span><span class="p">:</span> <span class="n">value</span>
  <span class="o">-</span> <span class="n">key</span><span class="p">:</span> <span class="n">value</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>If you want to associate information with a certain listed element, follow this structure:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">section</span> <span class="n">name</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">key</span><span class="p">:</span> <span class="n">value</span>
    <span class="n">key</span><span class="p">:</span> <span class="n">value</span>
  <span class="o">-</span> <span class="n">key</span><span class="p">:</span> <span class="n">value</span>
    <span class="n">key</span><span class="p">:</span> <span class="n">value</span>
</pre></div>
</div>
<p>Where each dash indicates a list.</p>
<ol class="arabic simple" start="4">
<li><p>Yamls also allow for the capability of reusable variables. These variables are defined by:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">ReusableVariable</span> <span class="n">Value</span>
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Users can apply a reusable variable on a block of values. For example, everything under “section” is associated with the reusable variable:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">section</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">ReusableVariable</span>
  <span class="o">-</span> <span class="n">key</span><span class="p">:</span> <span class="n">value</span>
    <span class="n">key</span><span class="p">:</span> <span class="n">value</span>
  <span class="o">-</span> <span class="n">key</span><span class="p">:</span> <span class="n">value</span>
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li><p>In order to use them as a reference else where in either the same or other yamls, use <code class="docutils literal notranslate"><span class="pre">*</span></code>:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span><span class="n">ReusableVariable</span>
</pre></div>
</div>
<ol class="arabic simple" start="7">
<li><p>If the reusable variable must be combined with other strings, the <strong>`!join`</strong> constructor is used. Simplified example:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;name &quot;experiment-name&quot;
...
pp_dir: !join [/archive/$USER/, *name, /, pp]
</pre></div>
</div>
<p>In this example, the variable <code class="docutils literal notranslate"><span class="pre">pp_dir</span></code> will be parsed as <code class="docutils literal notranslate"><span class="pre">/archive/$USER/experiment-name/pp</span></code>.</p>
</section>
<section id="model-yaml">
<h1>Model Yaml<a class="headerlink" href="#model-yaml" title="Link to this heading"></a></h1>
<p>The model yaml defines reusable variables, shared directories, switches, post-processing settings, and paths to compile and post-processing yamls. Required fields in the model yaml include: <code class="docutils literal notranslate"><span class="pre">fre_properties</span></code>, <code class="docutils literal notranslate"><span class="pre">build</span></code>, <code class="docutils literal notranslate"><span class="pre">shared</span></code>, and <code class="docutils literal notranslate"><span class="pre">experiments</span></code>.</p>
<ul>
<li><p><strong>fre_properties</strong>: Reusable variables</p>
<ul class="simple">
<li><p>list of variables</p></li>
<li><p>these values can be extracted from <code class="docutils literal notranslate"><span class="pre">fre_properties</span></code> in a group’s XML, if available</p></li>
<li><p>value type: string</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="o">&amp;</span><span class="n">variable1</span>  <span class="s2">&quot;value1&quot;</span>  <span class="p">(</span><span class="n">string</span><span class="p">)</span>
<span class="o">-</span> <span class="o">&amp;</span><span class="n">variable2</span>  <span class="s2">&quot;value2&quot;</span>  <span class="p">(</span><span class="n">string</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><strong>build</strong>: paths to information needed for compilation</p>
<ul class="simple">
<li><p>subsections: <code class="docutils literal notranslate"><span class="pre">compileYaml</span></code>, <code class="docutils literal notranslate"><span class="pre">platformYaml</span></code></p></li>
<li><p>value type: string</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">build</span><span class="p">:</span>
  <span class="n">compileYaml</span><span class="p">:</span> <span class="s2">&quot;path the compile yaml in relation to model yaml&quot;</span>   <span class="p">(</span><span class="n">string</span><span class="p">)</span>
  <span class="n">platformYaml</span><span class="p">:</span> <span class="s2">&quot;path to platforms.yaml in relation to model yaml&quot;</span> <span class="p">(</span><span class="n">string</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><strong>shared</strong>: shared settings across experiments</p>
<ul class="simple">
<li><p>subsections: <code class="docutils literal notranslate"><span class="pre">directories</span></code>, <code class="docutils literal notranslate"><span class="pre">postprocess</span></code></p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">shared</span><span class="p">:</span>
  <span class="n">directories</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">shared_directories</span>
    <span class="n">key</span><span class="p">:</span> <span class="s2">&quot;value&quot;</span>               <span class="p">(</span><span class="n">string</span><span class="p">)</span>

  <span class="n">postprocess</span><span class="p">:</span>
    <span class="n">settings</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">shared_settings</span>
      <span class="n">key</span><span class="p">:</span> <span class="s2">&quot;value&quot;</span>             <span class="p">(</span><span class="n">string</span><span class="p">)</span>
    <span class="n">switches</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">shared_switches</span>
      <span class="n">key</span><span class="p">:</span> <span class="kc">True</span><span class="o">/</span><span class="kc">False</span>          <span class="p">(</span><span class="n">boolean</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Be sure to define directories, settings, and switches as reusable variables as well</strong></p>
<ul>
<li><p>they will be “inherited” in the post-processing yamls created</p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>experiments</strong>: list of post-processing experiments</p>
<ul class="simple">
<li><p>subsections: <code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">pp</span></code>, <code class="docutils literal notranslate"><span class="pre">analysis</span></code></p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">experiments</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">name</span> <span class="n">of</span> <span class="n">post</span><span class="o">-</span><span class="n">processing</span> <span class="n">experiment</span>                                       <span class="p">(</span><span class="n">string</span><span class="p">)</span>
    <span class="n">pp</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">post</span><span class="o">-</span><span class="n">processing</span><span class="o">/</span><span class="n">yaml</span> <span class="k">for</span> <span class="n">that</span> <span class="n">experiment</span> <span class="ow">in</span> <span class="n">relation</span> <span class="n">to</span> <span class="n">model</span> <span class="n">yaml</span> <span class="p">(</span><span class="n">string</span><span class="p">)</span>
    <span class="n">analysis</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">analysis</span><span class="o">/</span><span class="n">yaml</span> <span class="k">for</span> <span class="n">that</span> <span class="n">experiment</span> <span class="ow">in</span> <span class="n">relation</span> <span class="n">to</span> <span class="n">model</span> <span class="n">yaml</span>        <span class="p">(</span><span class="n">string</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="compile-yaml">
<h1>Compile Yaml<a class="headerlink" href="#compile-yaml" title="Link to this heading"></a></h1>
<p>The compile yaml defines compilation information including component names, repos, branches, necessary flags, and necessary overrides. This is discussed more in the “Build FMS Model” section.</p>
</section>
<section id="platforms-yaml">
<h1>Platforms Yaml<a class="headerlink" href="#platforms-yaml" title="Link to this heading"></a></h1>
<p>The platform yaml contains user defined information for both bare-metal and container platforms. Information includes the platform name, the compiler used, necessary modules to load, an mk template, fc, cc, container build, and container run. This yaml file is not model specific.</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">platforms</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">the</span> <span class="n">platform</span> <span class="n">name</span>
    <span class="n">compiler</span><span class="p">:</span> <span class="n">the</span> <span class="n">compiler</span> <span class="n">you</span> <span class="n">are</span> <span class="n">using</span>
    <span class="n">modulesInit</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;array of commands that are needed to load modules.&quot;</span> <span class="p">,</span> <span class="s2">&quot;each command must end with a newline character&quot;</span><span class="p">]</span>
    <span class="n">modules</span><span class="p">:</span> <span class="p">[</span><span class="n">array</span> <span class="n">of</span> <span class="n">modules</span> <span class="n">to</span> <span class="n">load</span> <span class="n">including</span> <span class="n">compiler</span><span class="p">]</span>
    <span class="n">mkTemplate</span><span class="p">:</span> <span class="n">The</span> <span class="n">location</span> <span class="n">of</span> <span class="n">the</span> <span class="n">mkmf</span> <span class="n">make</span> <span class="n">template</span>
    <span class="n">modelRoot</span><span class="p">:</span> <span class="n">The</span> <span class="n">root</span> <span class="n">directory</span> <span class="n">of</span> <span class="n">the</span> <span class="n">model</span> <span class="p">(</span><span class="n">where</span> <span class="n">src</span><span class="p">,</span> <span class="n">exec</span><span class="p">,</span> <span class="n">experiments</span> <span class="n">will</span> <span class="n">go</span><span class="p">)</span>
  <span class="o">-</span> <span class="n">container</span> <span class="n">platform</span><span class="p">:</span> <span class="n">container</span> <span class="n">platform</span> <span class="n">name</span>
    <span class="n">compiler</span><span class="p">:</span> <span class="n">compiler</span> <span class="n">you</span> <span class="n">are</span> <span class="n">using</span>
    <span class="n">RUNenv</span><span class="p">:</span> <span class="n">Commands</span> <span class="n">needed</span> <span class="n">at</span> <span class="n">the</span> <span class="n">beginning</span> <span class="n">of</span> <span class="n">a</span> <span class="n">RUN</span> <span class="ow">in</span> <span class="n">dockerfile</span>
    <span class="n">modelRoot</span><span class="p">:</span> <span class="n">The</span> <span class="n">root</span> <span class="n">directory</span> <span class="n">of</span> <span class="n">the</span> <span class="n">model</span> <span class="p">(</span><span class="n">where</span> <span class="n">src</span><span class="p">,</span> <span class="n">exec</span><span class="p">,</span> <span class="n">experiments</span> <span class="n">will</span> <span class="n">go</span><span class="p">)</span> <span class="n">INSIDE</span> <span class="n">of</span> <span class="n">the</span> <span class="n">container</span> <span class="p">(</span><span class="o">/</span><span class="n">apps</span><span class="p">)</span>
    <span class="n">container</span><span class="p">:</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">this</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">container</span> <span class="n">platform</span>
    <span class="n">containerBuild</span><span class="p">:</span> <span class="s2">&quot;podman&quot;</span> <span class="o">-</span> <span class="n">the</span> <span class="n">container</span> <span class="n">build</span> <span class="n">program</span>
    <span class="n">containerRun</span><span class="p">:</span> <span class="s2">&quot;apptainer&quot;</span> <span class="o">-</span> <span class="n">the</span> <span class="n">container</span> <span class="n">run</span> <span class="n">program</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="post-processing-yaml">
<h1>Post-Processing Yaml<a class="headerlink" href="#post-processing-yaml" title="Link to this heading"></a></h1>
<p>The post-processing yamls include information specific to experiments, such as directories to data and other scripts used, switches, and component information. The post-processing yaml can further define more <code class="docutils literal notranslate"><span class="pre">fre_properties</span></code> that may be experiment specific. If there are any repeated reusable variables, the ones set in this yaml will overwrite those set in the model yaml. This is discussed further in the “Postprocess FMS History Output” section.</p>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Bennett Chang.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>